DDNODE=9

if $USE_EGOMAP
then
  echo '$$$$$ STARTING EGOMAP'
  
  if [ -w //$DDNODE/dev/photon ]; then
    echo "Photon detected on node $DDNODE, using it"
  else
    echo "Using photon on node $NODE"
    DDNODE=$NODE
  fi
		    
  cogcam="on -n$DDNODE -d cogcam -s //$DDNODE/dev/photon"
		      
  let x=10
  let y=10
  let xstep=150
  let ystep=300

  sin gna | grep -q "/viewer/egomap" || (
  $cogcam -x $x -y $y +/yarp/viewer/egomap &
  )			    
  let x=x+xstep
  let y=y+ystep
  sin gna | grep -q "/viewer/obj_segment" || (
  $cogcam -x $x -y $y +/yarp/viewer/obj_segment &
  )			    
  let x=x+xstep
  let y=y+ystep

  on -n10 slay -Q numb egomap
#  on -n10 sh -c "numb | egomap" &
  on -n10 -d egomap &
  on -n16 slay -Q obj_segment
  on -n16 -d obj_segment &
fi
			      
